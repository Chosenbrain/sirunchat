(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{217:function(e,t,a){},233:function(e,t){},235:function(e,t){},247:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(31),s=a.n(r),i=(a(217),a(18)),c=a(82),l=a(9);const d=a(319).a.create({baseURL:"http://localhost:5000"});d.interceptors.request.use((e=>{const t=localStorage.getItem("currentUser");if(t){const a=JSON.parse(t).token;console.log(a),e.headers.Authorization=`Bearer ${a}`}return e}),(e=>Promise.reject(e)));const h=e=>{var t;const a=null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status;a&&401===a&&(localStorage.clear(),window.location.pathname="/login")},u=async e=>d.post("/api/auth/subscribe",e);let p=function(e){return e[e.authenticate=0]="authenticate",e[e.logout=1]="logout",e[e.authError=2]="authError",e[e.authLoading=3]="authLoading",e[e.showAlert=4]="showAlert",e[e.hideAlert=5]="hideAlert",e[e.setFriends=6]="setFriends",e[e.setPendingInvitations=7]="setPendingInvitations",e[e.setOnlineUsers=8]="setOnlineUsers",e[e.setGroupChatList=9]="setGroupChatList",e[e.resetFriends=10]="resetFriends",e[e.setChatType=11]="setChatType",e[e.setChosenChatDetails=12]="setChosenChatDetails",e[e.setMessages=13]="setMessages",e[e.addNewMessage=14]="addNewMessage",e[e.resetChat=15]="resetChat",e[e.setChosenGroupChatDetails=16]="setChosenGroupChatDetails",e[e.setTyping=17]="setTyping",e[e.setInitialTypingStatus=18]="setInitialTypingStatus",e[e.setLocalStream=19]="setLocalStream",e[e.setRemoteStream=20]="setRemoteStream",e[e.setOtherUserId=21]="setOtherUserId",e[e.setAudioOnly=22]="setAudioOnly",e[e.setScreenSharingStream=23]="setScreenSharingStream",e[e.setScreenSharing=24]="setScreenSharing",e[e.setCallRequest=25]="setCallRequest",e[e.setCallStatus=26]="setCallStatus",e[e.resetVideoChatState=27]="resetVideoChatState",e[e.openRoom=28]="openRoom",e[e.setRoomDetails=29]="setRoomDetails",e[e.setActiveRooms=30]="setActiveRooms",e[e.setLocalStreamRoom=31]="setLocalStreamRoom",e[e.setRemoteStreams=32]="setRemoteStreams",e[e.setAudioOnlyRoom=33]="setAudioOnlyRoom",e[e.setScreenSharingStreamRoom=34]="setScreenSharingStreamRoom",e[e.setIsUserJoinedWithAudioOnly=35]="setIsUserJoinedWithAudioOnly",e}({});const j=e=>({type:p.showAlert,payload:e}),g=e=>({type:p.setMessages,payload:e}),m=e=>({type:p.addNewMessage,payload:e}),x=()=>({type:p.resetChat}),b=(e,t)=>async a=>{const n=await(async e=>{let{email:t}=e;try{return(await d.post("/api/invite-friend/invite",{email:t})).data}catch(a){return h(a),{error:!0,message:a.response.data}}})({email:e});"Invitation has been sent successfully"===n?(t(),a(j(n))):a(j(n.message))},O=e=>async t=>{const a=await(async e=>{try{return(await d.post("/api/invite-friend/reject",{invitationId:e})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})(e);t(j("Invitation rejected successfully!"===a?a:a.message))},f=e=>async t=>{const a=await(async e=>{try{return(await d.post("/api/invite-friend/accept",{invitationId:e})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})(e);t(j("Invitation accepted successfully!"===a?a:a.message))},v=e=>{let{friendId:t,friendName:a}=e;return async e=>{const n=await(async e=>{try{return(await d.post("/api/invite-friend/remove",{friendId:e.friendId})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})({friendId:t});"Friend removed successfully!"===n?(e(j(`You removed ${a} from your list of friends!`)),e(x())):e(j(n.message))}},y=function(e){const t="=".repeat((4-e.length%4)%4),a=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(a),o=new Uint8Array(n.length);for(let r=0;r<n.length;++r)o[r]=n.charCodeAt(r);return o}(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_VAPID_PUBLIC_KEY||"");function w(e){navigator.serviceWorker.ready.then((function(t){t.pushManager.getSubscription().then((function(t){if(t)return(e=>d.post("/api/auth/unsubscribe",e))(t).then((()=>(console.info("User is unsubscribed."),e(),t.unsubscribe())))})).catch((function(e){console.error("Error unsubscribing",e)})).then((function(){console.info("User is unsubscribed!!!"),e(),alert("Now turn off the notifications from the site settings to stop receiving notifications!")}))}))}const S=e=>async t=>{const a=await(async e=>{let{email:t,password:a}=e;try{return(await d.post("/api/auth/login",{email:t,password:a})).data}catch(n){return{error:!0,message:n.response.data}}})(e);"error"in a?(t({type:p.authError,payload:a.message}),t(j(a.message))):(localStorage.setItem("currentUser",JSON.stringify(a.userDetails)),t({type:p.authenticate,payload:a.userDetails}),t(j(`Hi, ${a.userDetails.username} \ud83d\udc4b. Welcome back.`)))},A=e=>async t=>{const a=await(async e=>{let{email:t,password:a,username:n}=e;try{return(await d.post("/api/auth/register",{email:t,password:a,username:n})).data}catch(o){return{error:!0,message:o.response.data}}})(e);"error"in a?(t({type:p.authError,payload:a.message}),t(j(a.message))):(localStorage.setItem("currentUser",JSON.stringify(a.userDetails)),t({type:p.authenticate,payload:a.userDetails}),t(j(`Hi \ud83d\udc4b ${a.userDetails.username}. Welcome to Sirunchat. the secured platform for you and your friends.`)))},C=()=>async e=>{e({type:p.authLoading,payload:!0});const t=JSON.parse(localStorage.getItem("currentUser")||"{}"),a=await(async()=>{try{return{me:(await d.get("/api/auth/me")).data.me,statusCode:200}}catch(t){var e;return console.log(t),{error:!0,statusCode:null===t||void 0===t||null===(e=t.response)||void 0===e?void 0:e.status}}})();401===a.statusCode||403===a.statusCode?(localStorage.clear(),e({type:p.authLoading,payload:!1})):t.token&&e({type:p.authenticate,payload:{...a.me,token:t.token}})},I=()=>async e=>{w((()=>{localStorage.removeItem("currentUser")})),e({type:p.logout}),e(x()),e({type:p.resetFriends}),e({type:p.resetChat})};var k=a(334),R=a(194),D=a(86),E=a(170),U=a(169);const T={userDetails:null,error:!1,errorMessage:"",loading:!1},B={open:!1,message:""},M={friends:[],pendingInvitations:[],onlineUsers:[],groupChatList:[]};var G=function(e){return e.direct="DIRECT",e.group="GROUP",e}(G||{});const L={chosenChatDetails:null,chosenGroupChatDetails:null,typing:[],chatType:G.direct,messages:[]},F={localStream:null,remoteStream:null,otherUserId:null,audioOnly:!1,screenSharingStream:null,screenSharing:!1,callRequest:null,callStatus:null};var z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.setLocalStream:return{...e,localStream:t.payload};case p.setRemoteStream:return{...e,remoteStream:t.payload};case p.setCallRequest:return{...e,callRequest:t.payload};case p.setCallStatus:return{...e,callStatus:t.payload.status};case p.setOtherUserId:return{...e,otherUserId:t.payload.otherUserId};case p.resetVideoChatState:return F;case p.setScreenSharingStream:return{...e,screenSharingStream:t.payload.stream,screenSharing:t.payload.isScreenSharing};case p.setAudioOnly:return{...e,audioOnly:t.payload.audioOnly};default:return e}};const W={isUserInRoom:!1,isUserRoomCreator:!1,roomDetails:null,activeRooms:[],localStreamRoom:null,remoteStreams:[],audioOnly:!1,screenSharingStream:null,isScreenSharingActive:!1,isUserJoinedWithOnlyAudio:!1},Q=Object(D.combineReducers)({auth:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.authenticate:return{error:!1,errorMessage:"",userDetails:t.payload,loading:!1};case p.authError:return{...e,error:!0,errorMessage:t.payload,loading:!1};case p.logout:return{error:!1,errorMessage:"",userDetails:null,loading:!1};case p.authLoading:return{error:!1,errorMessage:"",userDetails:null,loading:t.payload};default:return e}},alert:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.showAlert:return{open:!0,message:t.payload};case p.hideAlert:return{open:!1,message:""};default:return e}},friends:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.setPendingInvitations:return{...e,pendingInvitations:t.payload};case p.setFriends:return{...e,friends:t.payload};case p.setOnlineUsers:return{...e,onlineUsers:t.payload};case p.setGroupChatList:return{...e,groupChatList:t.payload};case p.resetFriends:return{...M};default:return e}},chat:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case p.setChosenChatDetails:return{...t,chosenGroupChatDetails:null,messages:[],chosenChatDetails:{userId:a.payload.userId,username:a.payload.username,isOnline:null!==(e=a.payload.isOnline)&&void 0!==e&&e}};case p.setChosenGroupChatDetails:return{...t,chosenChatDetails:null,messages:[],chosenGroupChatDetails:a.payload};case p.setMessages:return{...t,messages:a.payload};case p.addNewMessage:return{...t,messages:[...t.messages,a.payload]};case p.setInitialTypingStatus:return{...t,typing:a.payload};case p.setTyping:return{...t,typing:t.typing.map((e=>e.userId===a.payload.userId?a.payload:e))};case p.resetChat:return{...t,chosenChatDetails:null,chosenGroupChatDetails:null,messages:[]};default:return t}},videoChat:z,room:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.openRoom:return{...e,isUserInRoom:t.payload.isUserInRoom,isUserRoomCreator:t.payload.isUserRoomCreator};case p.setRoomDetails:return{...e,roomDetails:t.payload.roomDetails};case p.setActiveRooms:return{...e,activeRooms:t.payload.activeRooms};case p.setLocalStreamRoom:return{...e,localStreamRoom:t.payload.localStreamRoom};case p.setAudioOnlyRoom:return{...e,audioOnly:t.payload.audioOnly};case p.setRemoteStreams:return console.log(t.payload.remoteStreams),{...e,remoteStreams:t.payload.remoteStreams};case p.setScreenSharingStreamRoom:return{...e,screenSharingStream:t.payload.screenSharingStream,isScreenSharingActive:t.payload.isScreenSharingActive};case p.setIsUserJoinedWithAudioOnly:return{...e,isUserJoinedWithOnlyAudio:t.payload.isUserJoinedWithOnlyAudio};default:return e}}}),N=Object(D.createStore)(Q,Object(U.composeWithDevTools)(Object(D.applyMiddleware)(E.a))),Y=i.c,P=e=>({type:p.setRemoteStream,payload:e}),H=e=>({type:p.setCallStatus,payload:{status:e}}),V=e=>t=>{t({type:p.setCallRequest,payload:e}),null!==e&&void 0!==e&&e.callerUserId&&t({type:p.setOtherUserId,payload:{otherUserId:e.callerUserId}})},J=e=>(t,a)=>{const{videoChat:{localStream:n,screenSharingStream:o}}=a();null===n||void 0===n||n.getTracks().forEach((e=>e.stop())),null===o||void 0===o||o.getTracks().forEach((e=>e.stop())),t({type:p.resetVideoChatState}),t(j(e))},Z=e=>({type:p.setScreenSharingStream,payload:{stream:e,isScreenSharing:!!e}}),q=e=>({type:p.setAudioOnly,payload:{audioOnly:e}});var K=a(133),X=a.n(K);const _=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:p.openRoom,payload:{isUserRoomCreator:e,isUserInRoom:t}}},$=e=>({type:p.setRoomDetails,payload:{roomDetails:e}}),ee=e=>({type:p.setActiveRooms,payload:{activeRooms:e}}),te=e=>({type:p.setLocalStreamRoom,payload:{localStreamRoom:e}}),ae=e=>({type:p.setRemoteStreams,payload:{remoteStreams:e}}),ne=e=>({type:p.setScreenSharingStreamRoom,payload:{isScreenSharingActive:!!e,screenSharingStream:e||null}}),oe=e=>({type:p.setIsUserJoinedWithAudioOnly,payload:{isUserJoinedWithOnlyAudio:e}}),re=(e,t,a)=>{const n={audio:!0,video:!e};navigator.mediaDevices.getUserMedia(n).then((e=>{a?N.dispatch(te(e)):N.dispatch((e=>({type:p.setLocalStream,payload:e}))(e)),t&&t()})).catch((e=>{console.log(e),console.log("Error getting local stream")}))},se=()=>(console.warn("Using only STUN server"),{iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),ie=e=>{const t=N.getState().videoChat.localStream;if(!t)throw new Error("No local stream");console.log("from web ",t);const a=se();return new X.a({initiator:e,trickle:!1,config:a,stream:t})};let ce={};const le=(e,t)=>{const a=N.getState().room.localStreamRoom;t?console.log("preparing new peer connection as initiator"):console.log("preparing new peer connection as not initiator"),console.log("localStream",a),console.log("hello"),ce[e]=new X.a({initiator:t,config:se(),stream:a}),ce[e].on("signal",(t=>{ye({signal:t,connUserSocketId:e})})),ce[e].on("stream",(t=>{console.log("remote stream came from other user"),console.log("direct connection has been established"),t.connUserSocketId=e,de(t)}))},de=e=>{console.log("Hi");const t=[...N.getState().room.remoteStreams,e];N.dispatch(ae(t))},he=e=>{for(let t in ce)for(let a in ce[t].streams[0].getTracks())for(let n in e.getTracks())if(ce[t].streams[0].getTracks()[a].kind===e.getTracks()[n].kind){ce[t].replaceTrack(ce[t].streams[0].getTracks()[a],e.getTracks()[n],ce[t].streams[0]);break}},ue=()=>{var e;const t=null===(e=N.getState().room.roomDetails)||void 0===e?void 0:e.roomId,a=N.getState().room.localStreamRoom;a&&(a.getTracks().forEach((e=>e.stop())),N.dispatch(te(null)));const n=N.getState().room.screenSharingStream;n&&(n.getTracks().forEach((e=>e.stop())),N.dispatch(ne(null))),N.dispatch(ae([])),Object.entries(ce).forEach((e=>{const t=e[0];ce[t]&&(ce[t].destroy(),delete ce[t])})),t&&ve({roomId:t}),N.dispatch($(null)),N.dispatch(_(!1,!1))};let pe=null;let je;const ge=e=>{je=Object(R.a)("http://localhost:5000",{auth:{token:e.token}}),je.on("connect",(()=>{console.log(`Successfully connected to socket.io server. Connected socket.id: ${je.id}`)})),je.on("delete-chat-success",(e=>{console.log("Received delete-chat-success event from backend:",e),N.dispatch(g([]))})),je.on("delete-chat-failed",(e=>{console.error("Received delete-chat-failed event from backend:",e.message)})),je.on("delete-chat-confirmation",(e=>{const{userId:t}=e;console.log(`Chat with user ${t} has been deleted.`)})),je.emit("helloFomClient"),je.on("friend-invitations",(e=>{var t;N.dispatch((t=e,{type:p.setPendingInvitations,payload:t}))})),je.on("friends-list",(e=>{const t=e.map((e=>({userId:e.id,typing:!1})));var a,n;N.dispatch((a=t,{type:p.setInitialTypingStatus,payload:a})),N.dispatch((n=e,{type:p.setFriends,payload:n}))})),je.on("online-users",(e=>{var t;N.dispatch((t=e,{type:p.setOnlineUsers,payload:t}))})),je.on("groupChats-list",(e=>{var t;N.dispatch((t=e,{type:p.setGroupChatList,payload:t}))})),je.on("direct-chat-history",(e=>{const{messages:t,participants:a}=e,n=N.getState().chat.chosenChatDetails;if(n){const e=n.userId,o=N.getState().auth.userDetails._id;a.includes(e)&&a.includes(o)&&N.dispatch(g(t))}})),je.on("group-chat-history",(e=>{console.log(e);const{messages:t,groupChatId:a}=e,n=N.getState().chat.chosenGroupChatDetails;if(n){n.groupId===a&&N.dispatch(g(t))}})),je.on("direct-message",(e=>{const{newMessage:t,participants:a}=e,n=N.getState().chat.chosenChatDetails;if(n){const e=n.userId,o=N.getState().auth.userDetails._id;a.includes(e)&&a.includes(o)&&N.dispatch(m(t))}})),je.on("group-message",(e=>{const{newMessage:t,groupChatId:a}=e,n=N.getState().chat.chosenGroupChatDetails;if(n){n.groupId===a&&N.dispatch(m(t))}})),je.on("notify-typing",(e=>{var t;N.dispatch((t={typing:e.typing,userId:e.senderUserId},{type:p.setTyping,payload:t}))})),je.on("call-request",(e=>{N.dispatch(V(e))})),je.on("notify-chat-left",(()=>{N.dispatch(J("User left the chat...!"))})),je.on("room-create",(e=>{(e=>{const{roomDetails:t}=e;N.dispatch($(t))})(e)})),je.on("active-rooms",(e=>{(e=>{const{activeRooms:t}=e;console.log("Active ROOMS",t);const{friends:{friends:a},auth:{userDetails:n},room:{roomDetails:o}}=N.getState(),r=[],s=null===n||void 0===n?void 0:n._id;t.forEach((e=>{e.roomCreator.userId===s?r.push(e):a.forEach((t=>{t.id===e.roomCreator.userId&&r.push(e)})),e.roomId===(null===o||void 0===o?void 0:o.roomId)&&N.dispatch($(e))})),N.dispatch(ee(r))})(e)})),je.on("active-rooms-initial",(e=>{(e=>{const{activeRooms:t}=e;N.dispatch(ee(t))})(e)})),je.on("conn-prepare",(e=>{const{connUserSocketId:t}=e;le(t,!1),je.emit("conn-init",{connUserSocketId:t})})),je.on("conn-init",(e=>{const{connUserSocketId:t}=e;le(t,!0)})),je.on("conn-signal",(e=>{(e=>{const{connUserSocketId:t,signal:a}=e;ce[t]&&ce[t].signal(a)})(e)})),je.on("room-participant-left",(e=>{(e=>{const{connUserSocketId:t}=e;ce[t]&&(ce[t].destroy(),delete ce[t]);const a=N.getState().room.remoteStreams.filter((e=>e.connUserSocketId!==t));N.dispatch(ae(a))})(e)})),je.on("upload-file",me)},me=e=>{const{file:t,receiverUserId:a}=e,n=N.getState().auth.userDetails;n?N.dispatch(m({_id:Math.random().toString(36).substr(2,9),content:t.name,author:{username:n.username,_id:n._id},createdAt:(new Date).toISOString()})):console.error("User details are not available")},xe=e=>{const t=()=>{const t=ie(!0);pe=t,t.on("signal",(t=>{console.log("SIGNAL",t),je.emit("call-request",{...e,signal:t})})),t.on("stream",(e=>{console.log("REMOTE STREAM",e),N.dispatch(P(e))})),je.on("call-response",(e=>{const a=e.accepted?"accepted":"rejected";var n;N.dispatch(H(a)),e.accepted&&e.signal&&(console.log("ACCEPTED",e.signal),N.dispatch((n=e.otherUserId,{type:p.setOtherUserId,payload:{otherUserId:n}})),t.signal(e.signal))}))};re(e.audioOnly,(()=>{t(),N.dispatch(H("ringing")),N.dispatch(q(e.audioOnly))}))},be=e=>{if(je.emit("call-response",e),!e.accepted)return N.dispatch(V(null));re(e.audioOnly,(()=>{(()=>{var t;const a=ie(!1);pe=a,a.on("signal",(t=>{console.log("SIGNAL",t),je.emit("call-response",{...e,signal:t})})),a.on("stream",(e=>{console.log("REMOTE STREAM 1",e),N.dispatch(P(e))})),a.signal(null===(t=N.getState().videoChat.callRequest)||void 0===t?void 0:t.signal)})(),N.dispatch(V(null)),N.dispatch(q(e.audioOnly))}))},Oe=()=>{je.emit("room-create")},fe=e=>{je.emit("room-join",e)},ve=e=>{je.emit("room-leave",e)},ye=e=>{je.emit("conn-signal",e)};var we=a(332),Se=a(317),Ae=a(316),Ce=a(333),Ie=a(337),ke=a(113),Re=a.n(ke),De=a(336),Ee=a(1);const Ue=Object(k.a)("div")({borderRadius:"8px",width:"100%",height:"100%"}),Te=Object(k.a)("video")({height:"100%",borderRadius:"8px",display:"block",maxWidth:"100%",backgroundColor:"transparent"});var Be=e=>{let{stream:t,isLocalStream:a,dimensions:o}=e;const r=Object(n.useRef)(null);return Object(n.useEffect)((()=>{const e=r.current;e.srcObject=t,e.onloadedmetadata=()=>{e.play(),a&&(e.muted=!0,e.volume=0)}}),[t,a]),Object(Ee.jsx)(Ue,{style:{height:o.y,width:o.x},children:Object(Ee.jsx)(Te,{ref:r,autoPlay:!0,muted:a})})},Me=a(89);var Ge=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const[a,o]=Object(n.useState)({}),[r,s]=Object(n.useState)(window.matchMedia("(max-width: 480px)").matches);Object(n.useEffect)((()=>{const e=e=>{e.matches?s(!0):s(!1)};return window.matchMedia("(max-width: 480px)").addEventListener("change",e),()=>window.matchMedia("(max-width: 480px)").removeEventListener("change",e)}),[s]),Object(n.useEffect)((()=>{const e=()=>{if(r)return;const e=window.innerHeight-40,t=window.innerWidth;o({X:t,Y:e})},t=window.innerHeight-40,a=window.innerWidth;return o({X:a,Y:t}),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[r,o]);const{X:i=500,Y:c=800}=a,{x:l,y:d}=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const o=a,r=t,s=e;let i=Math.sqrt(r*s*n/o),c=Math.floor(r*n/i),l=Math.floor(s/i),d=c*l;for(;d<o;)i--,c=Math.floor(r*n/i),l=Math.floor(s/i),d=c*l;return{x:i,y:i/n}}(i,c,e,t);return{x:l,y:d,X:i,Y:c}};const Le=4/3,Fe=Object(k.a)("div")({height:"85%",width:"100%",padding:"10px",overflowY:"scroll",display:"flex",margin:"0px",flexDirection:"row",justifyContent:"center",gap:"10px",alignItems:"center",flexWrap:"wrap"});var ze=e=>{let{isRoomMinimized:t}=e;const{videoChat:{localStream:a,callStatus:n,remoteStream:o,screenSharingStream:r},room:{localStreamRoom:s,remoteStreams:i,screenSharingStream:c}}=Y((e=>e)),l=Object(De.a)("(max-width:800px)"),{x:d,y:h,X:u}=Ge(i.length+1,Le),{x:p,y:j}=Ge(2,Le);return Object(Ee.jsxs)(Fe,{sx:{...l&&t&&{height:"100%",width:"85%"}},children:[a&&Object(Ee.jsx)(Be,{stream:r||a,isLocalStream:!0,dimensions:{x:p,y:j}}),s&&Object(Ee.jsx)(Be,{stream:c||s,isLocalStream:!0,dimensions:{x:d,y:h}}),"accepted"!==n&&Object(Ee.jsx)(Me.a,{sx:{color:"#b9bbbe",fontSize:"15px",fontWeight:"bold",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"ringing"===n?"Ringing....":"rejected"===n&&"Call Rejected"}),o&&Object(Ee.jsx)(Be,{stream:o,isLocalStream:!1,dimensions:{x:p,y:j}}),i.map((e=>Object(Ee.jsx)(Be,{stream:e,isLocalStream:!1,dimensions:{x:d,y:h}},e.id)))]})},We=a(109),Qe=a.n(We),Ne=a(172),Ye=a.n(Ne);var Pe=e=>{let{localStream:t}=e;const[a,o]=Object(n.useState)(!0);return Object(Ee.jsx)(Ie.a,{onClick:()=>{t.getVideoTracks().forEach((e=>e.enabled=!e.enabled)),o(!a)},style:{color:"white"},children:a?Object(Ee.jsx)(Qe.a,{}):Object(Ee.jsx)(Ye.a,{})})},He=a(173),Ve=a.n(He),Je=a(174),Ze=a.n(Je);var qe=e=>{let{localStream:t}=e;const[a,o]=Object(n.useState)(!0);return Object(Ee.jsx)(Ie.a,{onClick:()=>{t.getAudioTracks().forEach((e=>e.enabled=!e.enabled)),o(!a)},style:{color:"white"},children:a?Object(Ee.jsx)(Ve.a,{}):Object(Ee.jsx)(Ze.a,{})})},Ke=a(175),Xe=a.n(Ke);var _e=e=>{let{type:t}=e;const a=Object(i.b)(),{videoChat:{otherUserId:n}}=Y((e=>e));return Object(Ee.jsx)(Ie.a,{onClick:()=>{var e;"DIRECT CALL"===t&&(n&&(e=n,je.emit("notify-chat-left",{receiverUserId:e})),a(J("You left the chat"))),"ROOM"===t&&ue()},style:{color:"white"},children:Object(Ee.jsx)(Xe.a,{})})},$e=a(177),et=a.n($e),tt=a(176),at=a.n(tt);var nt=e=>{let{videoChat:t,type:a,room:o}=e;const r=Object(i.b)(),[s,c]=Object(n.useState)(!1),l=async()=>{if(t)if(s){var e;try{var a;null===pe||void 0===pe||pe.replaceTrack(null===(a=t.screenSharingStream)||void 0===a?void 0:a.getVideoTracks()[0],pe.streams[0].getVideoTracks()[0],null===t||void 0===t?void 0:t.localStream)}catch(n){console.log(n)}null===(e=t.screenSharingStream)||void 0===e||e.getTracks().forEach((e=>e.stop())),r(Z(null)),c(!1)}else{const e=navigator.mediaDevices,t=await e.getDisplayMedia({video:!0,audio:!1});r(Z(t)),c(!0),null===pe||void 0===pe||pe.replaceTrack(pe.streams[0].getVideoTracks()[0],t.getTracks()[0],pe.streams[0])}},d=async()=>{if(console.log("hi"),console.log(o),o&&o.localStreamRoom)if(console.log("hi2"),s){var e;he(o.localStreamRoom),null===(e=o.screenSharingStream)||void 0===e||e.getTracks().forEach((e=>e.stop())),ne(null),c(!1)}else{console.log("hi3");let e=null;try{const t=navigator.mediaDevices;e=await t.getDisplayMedia({video:!0,audio:!1})}catch(t){console.log("error occurred when trying to get an access to screen share stream")}e&&(ne(e),he(e),c(!0))}};return Object(Ee.jsx)(Ie.a,{onClick:async()=>{"DIRECT CALL"===a&&l(),"ROOM"===a&&d()},style:{color:"white"},children:s?Object(Ee.jsx)(at.a,{}):Object(Ee.jsx)(et.a,{})})},ot=a(179),rt=a.n(ot),st=a(178),it=a.n(st);const ct=Object(k.a)("div")({});var lt=e=>{let{isRoomMinimized:t,handleRoomResize:a}=e;return Object(Ee.jsx)(ct,{children:Object(Ee.jsx)(Ie.a,{style:{color:"white"},onClick:a,children:t?Object(Ee.jsx)(it.a,{}):Object(Ee.jsx)(rt.a,{})})})};const dt=Object(k.a)("div")({height:"15%",width:"100%",backgroundColor:"#5865f2",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"});var ht=e=>{let{isRoomMinimized:t,handleRoomResize:a}=e;const{videoChat:n,room:o}=Y((e=>e)),r=Object(De.a)("(max-width:800px)");return Object(Ee.jsx)(Ee.Fragment,{children:n.localStream?Object(Ee.jsxs)(dt,{sx:{...r&&t&&{height:"100%",width:"15%",flexDirection:"column"}},children:[!n.audioOnly&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(nt,{videoChat:n,type:"DIRECT CALL"}),Object(Ee.jsx)(Pe,{localStream:n.localStream})]}),Object(Ee.jsx)(qe,{localStream:n.localStream}),Object(Ee.jsx)(_e,{type:"DIRECT CALL"}),Object(Ee.jsx)(lt,{isRoomMinimized:t,handleRoomResize:a})]}):o.localStreamRoom?Object(Ee.jsxs)(dt,{sx:{...r&&t&&{height:"100%",width:"15%",flexDirection:"column"}},children:[!o.isUserJoinedWithOnlyAudio&&Object(Ee.jsx)(nt,{room:o,type:"ROOM"}),Object(Ee.jsx)(qe,{localStream:o.localStreamRoom}),!o.isUserJoinedWithOnlyAudio&&Object(Ee.jsx)(Pe,{localStream:o.localStreamRoom}),Object(Ee.jsx)(_e,{type:"ROOM"}),Object(Ee.jsx)(lt,{isRoomMinimized:t,handleRoomResize:a})]}):null})};const ut=Object(k.a)("div")({position:"absolute",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#202225",transition:"all 0.5s ease-in-out"}),pt={height:"100vh",zIndex:200},jt={zIndex:200,top:"0px",right:"0px",width:"30%",height:"40vh"};var gt=()=>{const[e,t]=Object(n.useState)(!0),a=Object(De.a)("(max-width:800px)");return Object(Ee.jsxs)(ut,{sx:{...e?{...jt,...a&&{width:"70%"}}:{...pt,width:{xs:"calc(100vw)",sm:"calc(100vw - 240px)"}},...a&&e&&{flexDirection:"row"}},children:[Object(Ee.jsx)(ze,{isRoomMinimized:e}),Object(Ee.jsx)(ht,{isRoomMinimized:e,handleRoomResize:()=>{t(!e)}})]})},mt=a(338),xt=a(180),bt=a.n(xt),Ot=a(181),ft=a.n(Ot);const vt=Object(k.a)("div")({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",padding:"15px 20px",borderRadius:"30px"});var yt=()=>{const e=Y((e=>e.videoChat.callRequest)),t=(t,a)=>{be({receiverUserId:e.callerUserId,accepted:t,audioOnly:a})};return Object(Ee.jsx)(mt.a,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},open:!(null===e||void 0===e||!e.callerUserId),children:Object(Ee.jsxs)(vt,{children:[Object(Ee.jsxs)(Me.a,{sx:{color:"black",marginBottom:"3px",fontSize:"16px",fontWeight:"bold"},children:["Incoming ",null!==e&&void 0!==e&&e.audioOnly?"audio":"video"," call from"," ",null===e||void 0===e?void 0:e.callerName]}),Object(Ee.jsxs)("div",{children:[!(null!==e&&void 0!==e&&e.audioOnly)&&Object(Ee.jsx)(Ie.a,{color:"success",onClick:()=>{t(!0,!1)},children:Object(Ee.jsx)(Qe.a,{})}),Object(Ee.jsx)(Ie.a,{color:"success",onClick:()=>{t(!0,!0)},children:Object(Ee.jsx)(bt.a,{})}),Object(Ee.jsx)(Ie.a,{color:"error",onClick:()=>{t(!1,!0)},children:Object(Ee.jsx)(ft.a,{})})]})]})})},wt=a.p+"static/media/robot.0617a419.gif";const St=Object(k.a)("div")({flexGrow:1,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"16px",textAlign:"center"});var At=()=>Object(Ee.jsxs)(St,{children:[Object(Ee.jsx)("img",{src:wt,alt:"robot greeting welcome",style:{height:"15rem"}}),Object(Ee.jsx)(Me.a,{variant:"h6",sx:{color:"white"},children:"To start chatting - select a friend for conversation"})]}),Ct=a(134),It=a.n(Ct),kt=a(135),Rt=a.n(kt),Dt=a(136),Et=a.n(Dt);const Ut=Object(k.a)("div")({height:"32px",width:"32px",backgroundColor:"#5865f2",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"500",color:"white"});var Tt=e=>{let{username:t,large:a}=e;return Object(Ee.jsx)(Ut,{style:a?{height:"80px",width:"80px"}:{},children:null===t||void 0===t?void 0:t.substring(0,2)})},Bt=a(196),Mt=a(331),Gt=a(112),Lt=a.n(Gt),Ft=a(339),zt=a(313),Wt=a(344),Qt=a(340),Nt=a(341),Yt=a(327),Pt=a(37),Ht=a(330),Vt=a(326),Jt=a(342),Zt=a(320);const qt=(e,t)=>async a=>{const n=await(async e=>{try{return(await d.post("/api/group-chat",{name:e})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})(e);"Group created successfully"===n?(t(),a(j(n))):a(j(n.message))},Kt=(e,t)=>async a=>{const n=await(async e=>{try{return(await d.post("/api/group-chat/add",{friendIds:e.friendIds,groupChatId:e.groupChatId})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})(e);"Members added successfully!"===n?(t(),a(j(n))):a(j(n.message))},Xt=e=>async t=>{const a=await(async e=>{try{return(await d.post("/api/group-chat/leave",{groupChatId:e.groupChatId})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})(e);"You have left the group!"===a?(t(j(a)),t(x())):t(j(a.message))},_t=e=>{let{groupChatId:t,groupChatName:a}=e;return async e=>{const n=await(async e=>{try{return(await d.post("/api/group-chat/delete",{groupChatId:e.groupChatId})).data}catch(t){return h(t),{error:!0,message:t.response.data}}})({groupChatId:t});"Group deleted successfully!"===n?(e(j(`You deleted the "${a}" group!`)),e(x())):e(j(n.message))}},$t={PaperProps:{style:{maxHeight:224,width:250}}};function ea(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}var ta=e=>{let{isDialogOpen:t,closeDialogHandler:a}=e;const{friends:{friends:n},chat:{chosenGroupChatDetails:r}}=Y((e=>e)),s=null===r||void 0===r?void 0:r.participants.map((e=>e._id.toString())),c=Object(Pt.a)(),[l,d]=o.a.useState(s||[]),h=Object(i.b)(),u=()=>{a()};return Object(Ee.jsx)("div",{children:Object(Ee.jsxs)(Ft.a,{open:t,onClose:u,children:[Object(Ee.jsx)(zt.a,{children:Object(Ee.jsxs)(Me.a,{children:['Add friends to "',null===r||void 0===r?void 0:r.groupName,'" group']})}),Object(Ee.jsxs)(Qt.a,{children:[Object(Ee.jsx)(Nt.a,{children:Object(Ee.jsx)(Me.a,{children:"Select friends to add"})}),Object(Ee.jsxs)(Jt.a,{sx:{m:1,width:300},children:[Object(Ee.jsx)(Vt.a,{id:"demo-multiple-name-label",children:"Name"}),Object(Ee.jsx)(Zt.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:l,onChange:e=>{const{target:{value:t}}=e;d("string"===typeof t?t.split(","):t)},input:Object(Ee.jsx)(Ht.a,{label:"Name"}),MenuProps:$t,children:n.map((e=>Object(Ee.jsx)(Mt.a,{value:e.id,style:ea(e.username,l,c),children:e.username},e.id)))})]})]}),Object(Ee.jsx)(Wt.a,{children:Object(Ee.jsx)(Yt.a,{variant:"contained",sx:{bgcolor:"#5865F2",color:"white",textTransform:"none",fontSize:"16px",fontWeight:500,width:"100%",height:"40px",marginLeft:"15px",marginRight:"15px",marginBottom:"10px"},onClick:()=>{h(Kt({friendIds:l,groupChatId:null===r||void 0===r?void 0:r.groupId},u))},disabled:0===l.length,children:"Add"})})]})})},aa=a(343),na=a(325),oa=a(315),ra=a(345);var sa=e=>{let{isDialogOpen:t,closeDialogHandler:a,groupDetails:r,currentUserId:s}=e;return Object(Ee.jsx)("div",{children:Object(Ee.jsxs)(Ft.a,{open:t,onClose:()=>{a()},children:[Object(Ee.jsx)(zt.a,{children:Object(Ee.jsx)(Me.a,{children:r.groupName})}),Object(Ee.jsxs)(Qt.a,{children:[Object(Ee.jsx)(Nt.a,{children:Object(Ee.jsxs)(Me.a,{children:[r.participants.length," ",r.participants.length>1?"Participants":"Participant"]})}),Object(Ee.jsx)(aa.a,{sx:{width:"100%",maxWidth:300,bgcolor:"background.paper"},children:r.participants.map((e=>{var t;return Object(Ee.jsxs)(n.Fragment,{children:[Object(Ee.jsxs)(na.a,{alignItems:"flex-start",children:[Object(Ee.jsx)(ra.a,{children:Object(Ee.jsx)(Tt,{username:e.username})}),Object(Ee.jsx)(oa.a,{primary:`${e.username} ${e._id===s?"(You)":""}`,secondary:Object(Ee.jsxs)(o.a.Fragment,{children:[Object(Ee.jsx)(Me.a,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:e.email})," "+(e._id===(null===(t=r.admin)||void 0===t?void 0:t._id)?" \u2014 Group Admin":"")]})})]}),Object(Ee.jsx)(Ae.a,{variant:"inset",component:"li"})]},e._id)}))})]})]})})};function ia(){const[e,t]=o.a.useState(null),a=Boolean(e),[r,s]=Object(n.useState)(!1),[c,l]=Object(n.useState)(!1),{chat:{chosenGroupChatDetails:d,chosenChatDetails:h},auth:{userDetails:u}}=Y((e=>e)),p=Object(i.b)();return Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsxs)("div",{children:[Object(Ee.jsx)(Ie.a,{onClick:e=>t(e.currentTarget),style:{color:"white",marginLeft:"0px"},children:Object(Ee.jsx)(Lt.a,{})}),Object(Ee.jsxs)(Bt.a,{id:"basic-menu",anchorEl:e,open:a,onClose:()=>{t(null)},MenuListProps:{"aria-labelledby":"basic-button"},children:[d&&(d.admin._id===(null===u||void 0===u?void 0:u._id)?Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Mt.a,{onClick:()=>{s(!0)},children:"Add Members"}),Object(Ee.jsx)(Mt.a,{onClick:()=>{d&&p(_t({groupChatId:d.groupId,groupChatName:d.groupName}))},children:"Delete Group"})]}):Object(Ee.jsx)(Mt.a,{onClick:()=>{d&&p(Xt({groupChatId:d.groupId}))},children:"Leave Group"})),d&&Object(Ee.jsxs)(Mt.a,{onClick:()=>{l(!0)},children:["View Participants (",d.participants.length,")"]}),h&&Object(Ee.jsx)(Mt.a,{onClick:()=>{h&&p(v({friendId:h.userId,friendName:h.username}))},children:"Remove Friend"})]})]}),d&&u&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(ta,{isDialogOpen:r,closeDialogHandler:()=>{s(!1)}}),Object(Ee.jsx)(sa,{isDialogOpen:c,closeDialogHandler:()=>{l(!1)},groupDetails:d,currentUserId:u._id})]})]})}var ca=a(183),la=a.n(ca);const da=Object(k.a)("div")({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:"0px",padding:"8px 15px",background:"linear-gradient(90deg, rgba(255,0,0,1) 0%, rgba(0,255,0,1) 50%, rgba(0,0,255,1) 100%)",borderRadius:"0px 0px 20px 20px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:"20",color:"white","@media (max-width: 600px)":{padding:"5px 10px"}}),ha=Object(k.a)("div")({display:"block","@media (max-width: 600px)":{display:"none"}}),ua=Object(k.a)("div")({display:"flex",alignItems:"center",justifyContent:"center",flex:1,gap:"8px","@media (max-width: 600px)":{flexDirection:"column"}}),pa=Object(k.a)(Me.a)({fontSize:"12px",color:"#d3d3d3",marginTop:"-2px"}),ja=Object(k.a)("div")({display:"flex",alignItems:"center",gap:"8px","@media (max-width: 600px)":{display:"none"}});var ga=e=>{let{scrollPosition:t}=e;const a=Object(n.useRef)(null),[o,r]=Object(n.useState)(null),s=Boolean(o),{auth:{userDetails:i},chat:{chosenChatDetails:c},room:{isUserInRoom:l}}=Y((e=>e)),d=()=>{if(c&&i){const e={userId:i._id,otherUserId:c.userId};console.log("Attempting to delete chat with data:",e),(e=>{console.log("Emitting delete-chat event with data:",e),je.emit("delete-chat",e)})(e)}else console.error("Cannot delete chat: user details or chat details are missing")};return Object(Ee.jsxs)(da,{ref:a,children:[Object(Ee.jsx)(ha,{children:Object(Ee.jsx)(ia,{})}),Object(Ee.jsx)(ua,{children:c&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Tt,{username:c.username}),Object(Ee.jsxs)("div",{style:{textAlign:"center"},children:[Object(Ee.jsx)(Me.a,{variant:"h6",sx:{color:"white",fontSize:"16px"},children:c.username}),Object(Ee.jsx)(pa,{children:c.isOnline?"Online":"Offline"})]})]})}),Object(Ee.jsxs)(ja,{children:[Object(Ee.jsx)(Ie.a,{sx:{color:"#00acee",fontSize:"16px"},disabled:l,onClick:()=>xe({audioOnly:!0,callerName:i?i.username:"",receiverUserId:null===c||void 0===c?void 0:c.userId}),children:Object(Ee.jsx)(It.a,{fontSize:"small"})}),Object(Ee.jsx)(Ie.a,{sx:{color:"#00ff7f",fontSize:"16px"},disabled:l,onClick:()=>xe({audioOnly:!1,callerName:i?i.username:"",receiverUserId:null===c||void 0===c?void 0:c.userId}),children:Object(Ee.jsx)(Rt.a,{fontSize:"small"})}),Object(Ee.jsx)(Ie.a,{sx:{color:"red",fontSize:"16px"},onClick:d,children:Object(Ee.jsx)(Et.a,{fontSize:"small"})})]}),Object(Ee.jsx)(Ie.a,{"aria-label":"mobile menu",onClick:e=>{r(e.currentTarget)},sx:{display:{xs:"flex",md:"none"},color:"white"},children:Object(Ee.jsx)(Re.a,{})}),Object(Ee.jsxs)(Bt.a,{anchorEl:o,open:s,onClose:()=>{r(null)},keepMounted:!0,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[Object(Ee.jsxs)(Mt.a,{onClick:()=>{var e;return xe({audioOnly:!0,callerName:null!==(e=null===i||void 0===i?void 0:i.username)&&void 0!==e?e:"",receiverUserId:null===c||void 0===c?void 0:c.userId})},children:[Object(Ee.jsx)(It.a,{sx:{color:"#00acee",marginRight:"8px"}}),"Voice Call"]}),Object(Ee.jsxs)(Mt.a,{onClick:()=>{var e;return xe({audioOnly:!1,callerName:null!==(e=null===i||void 0===i?void 0:i.username)&&void 0!==e?e:"",receiverUserId:null===c||void 0===c?void 0:c.userId})},children:[Object(Ee.jsx)(Rt.a,{sx:{color:"#00ff7f",marginRight:"8px"}}),"Video Call"]}),Object(Ee.jsxs)(Mt.a,{onClick:d,children:[Object(Ee.jsx)(Et.a,{sx:{color:"red",marginRight:"8px"}}),"Delete Chat"]}),Object(Ee.jsxs)(Mt.a,{onClick:()=>{console.log("Remove friend")},children:[Object(Ee.jsx)(la.a,{sx:{color:"gray",marginRight:"8px"}}),"Remove Friend"]})]})]})};function ma(e){let t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return t%=12,t=t||12,a=a<10?"0"+a:a,t+":"+a+" "+n}const xa=Object(k.a)("div")({width:"99%",display:"flex",marginTop:"10px"}),ba=Object(k.a)("div")({width:"60px",display:"flex",justifyContent:"center",alignItems:"center"}),Oa=Object(k.a)("div")({display:"flex",flexDirection:"column",maxWidth:"50%"});var fa=e=>{let{content:t,sameAuthor:a,username:n,date:o,incomingMessage:r}=e;return r?Object(Ee.jsxs)(xa,{children:[!a&&Object(Ee.jsx)(ba,{children:Object(Ee.jsx)(Tt,{username:n})}),Object(Ee.jsxs)(Oa,{sx:{marginLeft:a?"60px":"0px",backgroundColor:"#fafafa",borderRadius:"13px",padding:"8px 12px"},children:[Object(Ee.jsx)(Me.a,{sx:{fontSize:"16px",color:"black",marginBottom:"2px"},children:t}),Object(Ee.jsx)(Me.a,{sx:{color:"#7f8183",fontSize:"10px"},children:ma(new Date(o))})]})]}):Object(Ee.jsx)(xa,{children:Object(Ee.jsx)(Oa,{sx:{marginLeft:"auto"},children:Object(Ee.jsxs)("div",{style:{color:"white",backgroundColor:"#5865f2",borderRadius:"13px",padding:"8px 12px"},children:[Object(Ee.jsx)(Me.a,{sx:{fontSize:"16px",color:"white",marginBottom:"2px"},children:t}),Object(Ee.jsx)(Me.a,{sx:{color:"#b9bbbe",textAlign:"right",fontSize:"10px"},children:ma(new Date(o))})]})})})};const va=Object(k.a)("div")({width:"95%",backgroundColor:"#b9bbbe",height:"1px",position:"relative",marginTop:"20px",marginBottom:"15px"}),ya=Object(k.a)("span")({backgroundColor:"#36393f",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#b9bbbe",padding:"0 5px",fontSize:"14px"});var wa=e=>{let{date:t}=e;return Object(Ee.jsx)(va,{children:Object(Ee.jsx)(ya,{children:new Date(t).toDateString()})})};const Sa=Object(k.a)("div")({height:"calc(100% - 142px)",overflow:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",alignItems:"center"});var Aa=()=>{var e,t;const a=Object(n.useRef)(null),[o,r]=Object(n.useState)(0),{chat:s,auth:{userDetails:i}}=Y((e=>e)),{chosenChatDetails:c,messages:l,chosenGroupChatDetails:d}=s,h=(e,t)=>0!==t&&e.author._id===l[t-1].author._id;return Object(n.useEffect)((()=>{var e;c&&(e={receiverUserId:c.userId},je.emit("direct-chat-history",e)),d&&(e=>{je.emit("group-chat-history",e)})({groupChatId:d.groupId})}),[c,d]),Object(n.useEffect)((()=>{a.current&&(null===a||void 0===a||a.current.scrollIntoView({behavior:"smooth"}))}),[l]),Object(Ee.jsxs)(Sa,{onScroll:e=>{r(e.currentTarget.scrollTop)},children:[Object(Ee.jsx)(ga,{scrollPosition:o}),Object(Ee.jsx)(Me.a,{sx:{color:"#b9bbbe",marginTop:"15px",fontSize:"13px"},children:null!==(e=s.chosenChatDetails)&&void 0!==e&&e.userId?`This is the beginning of your conversation with ${null===(t=s.chosenChatDetails)||void 0===t?void 0:t.username}`:"This is the beginning of the conversation with your friends!"}),l.map(((e,t)=>{var a;const n=new Date(e.createdAt).toDateString(),o=t>0&&new Date(null===(a=l[t-1])||void 0===a?void 0:a.createdAt).toDateString(),r=!(t>0)||n===o,s=e.author._id!==i._id;return Object(Ee.jsxs)("div",{style:{width:"97%"},children:[(!r||0===t)&&Object(Ee.jsx)(wa,{date:e.createdAt}),Object(Ee.jsx)(fa,{content:e.content,username:e.author.username,sameAuthor:h(e,t),date:e.createdAt,incomingMessage:s})]},e._id)})),Object(Ee.jsx)("div",{ref:a})]})},Ca=a(185),Ia=a.n(Ca),ka=a(184),Ra=a.n(ka);const Da=o.a.lazy((()=>a.e(3).then(a.bind(null,360)).then((e=>({default:e.Picker}))))),Ea=Object(k.a)("div")({height:"60px",width:"100%",display:"flex",alignItems:"center",padding:"0 10px",position:"relative"}),Ua=Object(k.a)("input")({backgroundColor:"#2f3136",width:"100%",height:"44px",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",padding:"0 10px",outline:"none"}),Ta=Object(k.a)(Ie.a)({color:"white",padding:"8px"}),Ba=Object(k.a)("div")({position:"absolute",bottom:"60px",right:"10px",zIndex:1e3});var Ma=()=>{const[e,t]=Object(n.useState)(""),[a,o]=Object(n.useState)(!1),[r,s]=Object(n.useState)(!1),{chosenChatDetails:i,chosenGroupChatDetails:c}=Y((e=>e.chat)),l=()=>{var a;""!==e.trim()&&(i&&(a={message:e,receiverUserId:i.userId},je.emit("direct-message",a)),c&&(e=>{je.emit("group-message",e)})({message:e,groupChatId:c.groupId}),t(""))};return Object(n.useEffect)((()=>{var t;null!==i&&void 0!==i&&i.userId&&(t={receiverUserId:i.userId,typing:a&&e.length>0},je.emit("notify-typing",t))}),[a,e,null===i||void 0===i?void 0:i.userId]),Object(Ee.jsxs)(Ea,{children:[Object(Ee.jsx)(Ie.a,{onClick:()=>s((e=>!e)),children:Object(Ee.jsx)(Ra.a,{sx:{color:"white"}})}),Object(Ee.jsx)(Ua,{placeholder:i?`Write message to ${i.username}`:c?`Write message in ${c.groupName}`:"Your message...",value:e,onChange:e=>{t(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&l()},onFocus:()=>o(!0),onBlur:()=>o(!1)}),Object(Ee.jsx)(Ta,{onClick:l,disabled:!e.trim(),children:Object(Ee.jsx)(Ia.a,{})}),r&&Object(Ee.jsx)(Ba,{children:Object(Ee.jsx)(n.Suspense,{fallback:Object(Ee.jsx)("div",{children:"Loading..."}),children:Object(Ee.jsx)(Da,{set:"apple",onSelect:e=>{t((t=>t+e.native)),s(!1)}})})})]})};const Ga=Object(k.a)("div")({display:"flex",alignItems:"center",height:"82px",width:"82px",marginLeft:"10px"});var La=()=>{const{chosenChatDetails:e,typing:t}=Y((e=>e.chat)),a=t.find((t=>t.userId===(null===e||void 0===e?void 0:e.userId)));return Object(Ee.jsx)(Ga,{children:a&&a.typing&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Tt,{username:null===e||void 0===e?void 0:e.username}),Object(Ee.jsx)("img",{src:"data:image/gif;base64,R0lGODlh6gDBAPUgAISGhvz8/M/Pz+Xl5fLy8uzs7N/f39LS0vX19fn5+ff399XV1YuNjeDh4e/v78HCwqKkpOLi4rKzs+np6dzc3JOVlejo6Kqrq9HR0djZ2ZucnPDw8Lq7u8nKytnZ2czMzP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzFEMDA4MThBRUY3MTFFNkIzQUZFNzI0NEI4NkE3RUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzFEMDA4MTlBRUY3MTFFNkIzQUZFNzI0NEI4NkE3RUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEQjhBQkM3RkFFRjIxMUU2QjNBRkU3MjQ0Qjg2QTdFQiIg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",alt:"dots",style:{height:"50%",width:"50%",marginLeft:"3px"}})]})})};const Fa=Object(k.a)("div")({flexGrow:1});var za=()=>Object(Ee.jsxs)(Fa,{children:[Object(Ee.jsx)(Aa,{}),Object(Ee.jsx)(La,{}),Object(Ee.jsx)(Ma,{})]});const Wa=Object(k.a)("div")({flexGrow:1,backgroundColor:"#36393f",display:"flex"});var Qa=()=>{const{chosenChatDetails:e,chosenGroupChatDetails:t}=Y((e=>e.chat));return Object(Ee.jsx)(Wa,{children:null!==e&&void 0!==e&&e.userId||null!==t&&void 0!==t&&t.groupId?Object(Ee.jsx)(za,{}):Object(Ee.jsx)(At,{})})};const Na=e=>{let{email:t,password:a}=e;const n={};return Ha(t)||(n.email="Invalid email address."),Pa(a)||(n.password="Password must be at least 6 characters."),n},Ya=e=>{let{email:t,password:a,username:n}=e;const o={};return Ha(t)||(o.email="Invalid email address."),Pa(a)||(o.password="Password must be at least 6 characters."),Va(n)||(o.username="Username must be between 3 and 12 characters."),o},Pa=e=>e.length>5,Ha=e=>/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e),Va=e=>e.length>2&&e.length<13;var Ja=a(35);const Za=Object(Ja.a)("div")({display:"flex",justifyContent:"center",flexDirection:"column",width:"100%"}),qa=Object(Ja.a)("p")({color:"#b9bbbe",textTransform:"uppercase",fontWeight:"600",fontSize:"16px"}),Ka=Object(Ja.a)("input")({flexGrow:1,height:"40px",border:"1px solid black",borderRadius:"5px",color:"#dcddde",background:"#35393f",margin:0,fontSize:"16px",padding:"0 5px",outline:"none"});var Xa=e=>{let{isDialogOpen:t,closeDialogHandler:a}=e;const[o,r]=Object(n.useState)(""),[s,c]=Object(n.useState)(!1),l=Object(i.b)(),d=()=>{a(),r("")};return Object(n.useEffect)((()=>{c(Ha(o))}),[o,c]),Object(Ee.jsx)("div",{children:Object(Ee.jsxs)(Ft.a,{open:t,onClose:d,children:[Object(Ee.jsx)(zt.a,{children:Object(Ee.jsx)(Me.a,{children:"Invite a Friend"})}),Object(Ee.jsxs)(Qt.a,{children:[Object(Ee.jsx)(Nt.a,{children:Object(Ee.jsx)(Me.a,{children:"Enter email address of friend which you would like to invite"})}),Object(Ee.jsxs)(Za,{children:[Object(Ee.jsx)(qa,{children:"Invite your friend"}),Object(Ee.jsx)(Ka,{type:"email",placeholder:"Enter email of your friend",value:o,onChange:e=>r(e.target.value)})]})]}),Object(Ee.jsx)(Wt.a,{children:Object(Ee.jsx)(Yt.a,{variant:"contained",sx:{bgcolor:"#5865F2",color:"white",textTransform:"none",fontSize:"16px",fontWeight:500,width:"100%",height:"40px",marginLeft:"15px",marginRight:"15px",marginBottom:"10px"},disabled:!s,onClick:()=>{l(b(o,d))},children:"Invite"})})]})})};var _a=()=>{const[e,t]=Object(n.useState)(!1);return Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Yt.a,{variant:"contained",sx:{bgcolor:"#5865F2",color:"white",textTransform:"none",fontSize:"16px",fontWeight:500,width:"120px",height:"30px",background:"#3ba55d",left:"0"},onClick:()=>{t(!0)},children:"Add friend"}),Object(Ee.jsx)(Xa,{isDialogOpen:e,closeDialogHandler:()=>{t(!1)}})]})},$a=a(318),en=a(186),tn=a.n(en);var an=e=>{let{isOnline:t}=e;return Object(Ee.jsx)(we.a,{sx:{color:t?"#3ba55d":"#c0c0c0",display:"flex",alignItems:"center",position:"absolute",right:"5px"},"aria-label":t?"Online":"Offline",children:Object(Ee.jsx)(tn.a,{})})};var nn=e=>{let{id:t,username:a,isOnline:n,email:o,onSelectFriend:r}=e;const s=Object(Pt.a)(),c=Object(De.a)(s.breakpoints.up("sm")),{chosenChatDetails:l,typing:d}=(Object(i.b)(),Y((e=>e.chat))),h=d.find((e=>e.userId===t)),u=h&&h.typing&&t!==(null===l||void 0===l?void 0:l.userId),p=(null===l||void 0===l?void 0:l.userId)===t;return Object(Ee.jsx)($a.a,{title:o,children:Object(Ee.jsxs)(Yt.a,{onClick:r,style:{width:"100%",height:"42px",marginTop:"15px",display:"flex",alignItems:"center",justifyContent:"flex-start",textTransform:"none",color:"black",position:"relative",backgroundColor:p?"#36393f":"transparent"},children:[c&&Object(Ee.jsx)(Tt,{username:a}),Object(Ee.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:[Object(Ee.jsx)(Me.a,{style:{marginLeft:"7px",fontWeight:700,color:"#8e9297"},variant:"subtitle1",align:"left",children:a}),u&&Object(Ee.jsx)(Me.a,{style:{marginLeft:"7px",fontWeight:500,fontSize:"15px",color:"#3ba55d"},variant:"subtitle1",align:"left",children:"typing....."})]}),n&&Object(Ee.jsx)(an,{isOnline:n})]})})};const on=Object(k.a)("div")({flexGrow:1,width:"100%",margin:"20px 0"});var rn=()=>{const e=Object(i.b)(),{friends:t,onlineUsers:a}=Y((e=>e.friends)),n=t.map((e=>{const t=a.find((t=>t.userId===e.id));return{...e,isOnline:!!t}})),o=t=>{var a;e((a={userId:t.id,username:t.username,isOnline:t.isOnline||!1},{type:p.setChosenChatDetails,payload:a}))};return Object(Ee.jsx)(on,{children:n.map((e=>Object(Ee.jsx)(nn,{username:e.username,id:e.id,isOnline:e.isOnline||!1,email:e.email,onSelectFriend:()=>o(e)},e.id)))})},sn=a(189),cn=a.n(sn),ln=a(188),dn=a.n(ln),hn=a(137),un=a.n(hn);var pn=e=>{let{title:t}=e;return Object(Ee.jsxs)(Me.a,{sx:{textTransform:"uppercase",color:"#8e9297",fontSize:"14px",marginTop:"20px",display:"flex",alignItems:"center",gap:"10px"},children:["Private Messages"===t?Object(Ee.jsx)(dn.a,{}):"Group Chats"===t||"Active Rooms"===t?Object(Ee.jsx)(un.a,{}):Object(Ee.jsx)(cn.a,{}),t]})},jn=a(190),gn=a.n(jn),mn=a(191),xn=a.n(mn);var bn=e=>{let{color:t,invitationId:a}=e;const n=Object(i.b)();return Object(Ee.jsxs)(we.a,{sx:{display:"flex"},children:[Object(Ee.jsx)(Ie.a,{style:{color:t||"white"},onClick:()=>{n(f(a))},children:Object(Ee.jsx)(gn.a,{})}),Object(Ee.jsx)(Ie.a,{style:{color:t||"white"},onClick:()=>{n(O(a))},children:Object(Ee.jsx)(xn.a,{})})]})};var On=e=>{let{id:t,username:a,email:n}=e;const o=Object(Pt.a)();Object(De.a)(o.breakpoints.up("sm"));return Object(Ee.jsx)($a.a,{title:n,children:Object(Ee.jsx)("div",{style:{width:"100%"},children:Object(Ee.jsxs)(we.a,{sx:{width:"100%",height:"42px",marginTop:"10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(Ee.jsx)(Tt,{username:a}),Object(Ee.jsx)(Me.a,{sx:{marginLeft:"7px",fontWeight:700,color:"#8e9297",flexGrow:1},children:a}),Object(Ee.jsx)(bn,{invitationId:t})]})})})};const fn=Object(k.a)("div")({width:"100%",display:"flex",flexDirection:"column",alignItems:"center",margin:"10px 0"});var vn=()=>{const{pendingInvitations:e}=Y((e=>e.friends));return Object(Ee.jsx)(fn,{children:e.map((e=>Object(Ee.jsx)(On,{id:e._id,username:e.senderId.username,email:e.senderId.email},e._id)))})},yn=a(328);var wn=e=>{let{isDialogOpen:t,closeDialogHandler:a,roomDetails:r,currentUserId:s}=e;return Object(Ee.jsx)("div",{children:Object(Ee.jsxs)(Ft.a,{open:t,onClose:()=>{a()},children:[Object(Ee.jsx)(zt.a,{children:Object(Ee.jsx)(Me.a,{children:`${r.roomCreator.username}'s Room`})}),Object(Ee.jsxs)(Qt.a,{children:[Object(Ee.jsx)(Nt.a,{children:Object(Ee.jsxs)(Me.a,{children:[r.participants.length," ",r.participants.length>1?"Participants":"Participant"]})}),Object(Ee.jsx)(aa.a,{sx:{width:"100%",maxWidth:300,bgcolor:"background.paper"},children:r.participants.map((e=>{var t;return Object(Ee.jsxs)(n.Fragment,{children:[Object(Ee.jsxs)(na.a,{alignItems:"flex-start",children:[Object(Ee.jsx)(ra.a,{children:Object(Ee.jsx)(Tt,{username:e.username})}),Object(Ee.jsx)(oa.a,{primary:`${e.username} ${e.userId===s?"(You)":""}`,secondary:Object(Ee.jsx)(o.a.Fragment,{children:Object(Ee.jsx)(Me.a,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:" "+(e.userId===(null===(t=r.roomCreator)||void 0===t?void 0:t.userId)?" \u2014 Host":"")})})})]}),Object(Ee.jsx)(Ae.a,{variant:"inset",component:"li"})]},e.userId)}))})]})]})})};function Sn(){const[e,t]=o.a.useState(!1),[a,r]=Object(n.useState)(!1),[s,c]=o.a.useState(null),l=Boolean(s),d=Object(i.b)(),{auth:{userDetails:h},room:{audioOnly:j,roomDetails:g,isUserInRoom:m}}=Y((e=>e));return Object(n.useEffect)((()=>{"serviceWorker"in navigator?navigator.serviceWorker.ready.then((function(e){e.pushManager.getSubscription().then((function(e){"granted"===Notification.permission&&e?t(!0):t(!1)}))})):(console.warn("Service Worker is not supported in this environment."),t(!1))}),[]),Object(Ee.jsxs)("div",{children:[Object(Ee.jsx)(Ie.a,{onClick:e=>c(e.currentTarget),style:{color:"white",marginLeft:"20px"},children:Object(Ee.jsx)(Lt.a,{})}),Object(Ee.jsxs)(Bt.a,{id:"basic-menu",anchorEl:s,open:l,onClose:()=>{c(null)},MenuListProps:{"aria-labelledby":"basic-button"},children:[Object(Ee.jsx)(Mt.a,{onClick:()=>{d((e=>({type:p.setAudioOnlyRoom,payload:{audioOnly:e}}))(!j))},children:j?"Audio Only Enabled (for Rooms)":"Audio Only Disabled (for Rooms)"}),m&&g&&Object(Ee.jsxs)(Mt.a,{onClick:()=>{r(!0)},children:["Active Room (",g.roomCreator.username,")"]}),Object(Ee.jsxs)(Mt.a,{children:["Notifications"," ",Object(Ee.jsx)(yn.a,{checked:e,onChange:(e,a)=>{e.target.checked?new Promise((function(e,t){const a=Notification.requestPermission((function(t){e(t)}));a&&a.then(e,t)})).then((e=>"granted"===e||(alert("Can't turn on the notifications. First enable notifications from the browser settings and then try again!"),!1))).then((e=>{var a;e?(a=()=>{t(!0)},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.pushManager?e.pushManager.getSubscription().then((function(t){if(null!==t)return console.info("Existing subscription detected."),u(t).then((()=>{a()}));{console.info("No push subscription detected. Making one..");const t={userVisibleOnly:!0,applicationServerKey:y};e.pushManager.subscribe(t).then((function(e){return console.log("New push subscription added."),u(e).then((()=>{a()}))})).catch((function(e){"granted"!==Notification.permission?console.info("Permission was not granted."):console.error("An error ocurred during the subscription process.",e)}))}})):console.warn("Push manager unavailable.")}))):alert("Can't turn on the notifications. First enable notifications from the browser settings and then try again!")})):w((()=>{t(!1)}))}})]}),Object(Ee.jsxs)(Mt.a,{onClick:()=>{d(I())},children:["Logout (",null===h||void 0===h?void 0:h.username,")"]})]}),g&&h&&Object(Ee.jsx)(wn,{isDialogOpen:a,closeDialogHandler:()=>{r(!1)},roomDetails:g,currentUserId:h._id})]})}var An=a(192),Cn=a.n(An);var In=e=>{let{isUserInRoom:t}=e;return Object(Ee.jsx)(Yt.a,{disabled:t,onClick:()=>{(()=>{const e=N.getState().room.audioOnly;re(e,(()=>{N.dispatch(_(!0,!0));const e=N.getState().room.audioOnly;N.dispatch(oe(e)),Oe()}),!0)})()},style:{width:"48px",height:"48px",borderRadius:"16px",margin:0,padding:0,minWidth:0,marginTop:"10px",color:"white",backgroundColor:"#5865F2"},children:Object(Ee.jsx)(Cn.a,{})})};const kn=Object(Ja.a)("div")({display:"flex",justifyContent:"center",flexDirection:"column",width:"100%"}),Rn=Object(Ja.a)("p")({color:"#b9bbbe",textTransform:"uppercase",fontWeight:"600",fontSize:"16px"}),Dn=Object(Ja.a)("input")({flexGrow:1,height:"40px",border:"1px solid black",borderRadius:"5px",color:"#dcddde",background:"#35393f",margin:0,fontSize:"16px",padding:"0 5px",outline:"none"});var En=e=>{let{isDialogOpen:t,closeDialogHandler:a}=e;const[o,r]=Object(n.useState)(""),[s,c]=Object(n.useState)(!1),l=Object(i.b)(),d=()=>{a(),r("")};return Object(n.useEffect)((()=>{c((e=>e.length>2&&e.length<13)(o))}),[o,c]),Object(Ee.jsx)("div",{children:Object(Ee.jsxs)(Ft.a,{open:t,onClose:d,children:[Object(Ee.jsx)(zt.a,{children:Object(Ee.jsx)(Me.a,{children:"Create a Group Chat"})}),Object(Ee.jsxs)(Qt.a,{children:[Object(Ee.jsx)(Nt.a,{children:Object(Ee.jsx)(Me.a,{children:"Enter name of the group"})}),Object(Ee.jsxs)(kn,{children:[Object(Ee.jsx)(Rn,{children:"Create a Group"}),Object(Ee.jsx)(Dn,{type:"name",placeholder:"Enter a group name.",value:o,onChange:e=>r(e.target.value)})]})]}),Object(Ee.jsx)(Wt.a,{children:Object(Ee.jsx)(Yt.a,{variant:"contained",sx:{bgcolor:"#5865F2",color:"white",textTransform:"none",fontSize:"16px",fontWeight:500,width:"100%",height:"40px",marginLeft:"15px",marginRight:"15px",marginBottom:"10px"},disabled:!s,onClick:()=>{l(qt(o,d))},children:"Create"})})]})})},Un=a(193),Tn=a.n(Un);var Bn=()=>{const[e,t]=Object(n.useState)(!1);return Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Yt.a,{variant:"contained",onClick:()=>{t(!0)},style:{width:"48px",height:"48px",borderRadius:"16px",margin:0,padding:0,minWidth:0,color:"white",backgroundColor:"#5865F2"},children:Object(Ee.jsx)(Tn.a,{})}),Object(Ee.jsx)(En,{isDialogOpen:e,closeDialogHandler:()=>{t(!1)}})]})};var Mn=e=>{let{chat:t}=e;const a=Object(Pt.a)(),n=(Object(De.a)(a.breakpoints.up("sm")),Object(i.b)()),{chosenGroupChatDetails:o}=Y((e=>e.chat)),r=(null===o||void 0===o?void 0:o.groupId)===t.groupId;return Object(Ee.jsx)($a.a,{title:t.groupName,children:Object(Ee.jsx)(Yt.a,{onClick:()=>{var e;n((e=t,{type:p.setChosenGroupChatDetails,payload:e}))},style:{width:"100%",height:"42px",marginTop:"15px",display:"flex",alignItems:"center",justifyContent:"flex-start",textTransform:"none",color:"black",position:"relative",backgroundColor:r?"#36393f":"transparent"},children:Object(Ee.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:Object(Ee.jsx)(Me.a,{style:{marginLeft:"7px",fontWeight:700,color:"#8e9297"},variant:"subtitle1",align:"left",children:t.groupName})})})})};const Gn=Object(k.a)("div")({flexGrow:1,width:"100%",margin:"20px 0"});var Ln=()=>{const{groupChatList:e}=Y((e=>e.friends));return Object(Ee.jsx)(Gn,{children:e.map((e=>Object(Ee.jsx)(Mn,{chat:e},e.groupId)))})};var Fn=e=>{let{creatorUsername:t,isUserInRoom:a,room:n,alreadyInDirectCall:o}=e;const r=o,s=`Creator: ${t}. Connected: ${n.participants.length}`;return Object(Ee.jsx)($a.a,{title:s,children:Object(Ee.jsx)("div",{children:Object(Ee.jsx)(Yt.a,{style:{width:"48px",height:"48px",borderRadius:"16px",margin:0,padding:0,minWidth:0,marginTop:"10px",color:"white",backgroundColor:"#5865F2"},disabled:r||a,onClick:()=>{(e=>{const t=N.getState().room.audioOnly;re(t,(()=>{N.dispatch($(e)),N.dispatch(_(!1,!0));const t=N.getState().room.audioOnly;N.dispatch(oe(t)),fe({roomId:e.roomId})}),!0)})(n)},children:Object(Ee.jsx)(Tt,{username:t})})})})};const zn=Object(k.a)("div")({flexGrow:1,display:"flex",gap:"10px",flexWrap:"wrap",width:"100%",margin:"20px 0"});var Wn=()=>{const{room:{activeRooms:e,isUserInRoom:t},auth:{userDetails:a},videoChat:{localStream:n}}=Y((e=>e));return console.log(e),Object(Ee.jsx)(zn,{children:e.map((e=>Object(Ee.jsx)(Fn,{creatorUsername:(null===a||void 0===a?void 0:a._id)===e.roomCreator.userId?"ME":e.roomCreator.username,isUserInRoom:t,room:e,alreadyInDirectCall:!!n},e.roomId)))})};const Qn=240;function Nn(e){const{window:t}=e,[a,o]=n.useState(!1),r=()=>{o(!a)},s=Object(Ee.jsxs)("div",{style:{backgroundColor:"#2F3136",height:"100%",overflowY:"auto",padding:"5px 15px"},children:[Object(Ee.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"10px 0"},children:[Object(Ee.jsx)(_a,{}),Object(Ee.jsx)(Sn,{})]}),Object(Ee.jsx)(Ae.a,{}),Object(Ee.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-around",margin:"10px 0"},children:[Object(Ee.jsx)(Bn,{}),Object(Ee.jsx)(In,{isUserInRoom:e.isUserInRoom})]}),e.hasActiveRooms&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(pn,{title:"Active Rooms"}),Object(Ee.jsx)(Wn,{}),Object(Ee.jsx)(Ae.a,{})]}),e.hasFriends&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(pn,{title:"Private Messages"}),Object(Ee.jsx)(rn,{}),Object(Ee.jsx)(Ae.a,{})]}),e.hasGroupChats&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(pn,{title:"Group Chats"}),Object(Ee.jsx)(Ln,{}),Object(Ee.jsx)(Ae.a,{})]}),e.hasInvitations&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(pn,{title:"Invitations"}),Object(Ee.jsx)(vn,{}),Object(Ee.jsx)(Ae.a,{})]})]}),i=void 0!==t?()=>t().document.body:void 0;return Object(Ee.jsxs)(we.a,{sx:{display:"flex"},children:[Object(Ee.jsx)(Se.a,{}),Object(Ee.jsx)(Ie.a,{style:{position:"fixed",top:10,left:17,zIndex:1e3,color:"white"},"aria-label":"open drawer",edge:"start",onClick:r,sx:{mr:2,display:{sm:"none"}},children:Object(Ee.jsx)(Re.a,{})}),Object(Ee.jsxs)(we.a,{component:"nav",sx:{width:{sm:Qn},flexShrink:{sm:0}},"aria-label":"mailbox folders",children:[Object(Ee.jsx)(Ce.a,{container:i,variant:"temporary",open:a,onClose:r,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Qn}},children:s}),Object(Ee.jsx)(Ce.a,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Qn}},open:!0,children:s})]}),Object(Ee.jsxs)(we.a,{component:"main",sx:{flexGrow:1,display:"flex",background:"red",width:{xs:"calc(100vw)",sm:"calc(100vw - 240px)"}},children:[Object(Ee.jsx)(Qa,{}),e.localStream&&Object(Ee.jsx)(gt,{}),Object(Ee.jsx)(yt,{})]})]})}const Yn=Object(k.a)("div")({width:"100%",height:"100vh",display:"flex"});var Pn=()=>{const{auth:{userDetails:e},videoChat:{localStream:t},room:{isUserInRoom:a=!1,localStreamRoom:o=null,activeRooms:r=[]}={},friends:{friends:s=[],pendingInvitations:i=[]},friends:{groupChatList:c=[]}}=Y((e=>e)),d=Object(l.q)();return Object(n.useEffect)((()=>{(null===e||void 0===e?void 0:e.token)?ge(e):d("/login")}),[e,d]),Object(Ee.jsx)(Yn,{children:Object(Ee.jsx)(Nn,{localStream:t||o,isUserInRoom:a,hasFriends:s.length>0,hasGroupChats:c.length>0,hasActiveRooms:r.length>0,hasInvitations:i.length>0})})},Hn=a(329),Vn=a(115),Jn=a.n(Vn),Zn=a(114),qn=a.n(Zn),Kn=a.p+"static/media/sirun-logo.3ccb0894.png";const Xn=Object(k.a)(we.a)({display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"radial-gradient(circle at top left, #1f2235, #141625)",padding:"20px"}),_n=Object(k.a)(Hn.a)({padding:"40px 35px",maxWidth:"400px",width:"100%",background:"#1e1f2b",borderRadius:"15px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.6)",textAlign:"center",color:"#d9d9d9",position:"relative",animation:"fadeIn 1s ease-out","@keyframes fadeIn":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}},"@media (max-width: 600px)":{padding:"30px 20px",maxWidth:"90%"}}),$n=Object(k.a)("img")({width:"70px",height:"70px",marginBottom:"25px",filter:"brightness(1.3) contrast(1.1)"}),eo=Object(k.a)(Me.a)({color:"#b3b5c3",fontSize:"0.85rem",fontWeight:600,marginBottom:"8px",textAlign:"left","@media (max-width: 600px)":{fontSize:"0.8rem"}}),to=Object(k.a)("input")({width:"100%",height:"45px",border:"1px solid #3a3b4d",borderRadius:"8px",background:"#252738",padding:"0 15px",color:"#e0e0e0",fontSize:"1rem",marginBottom:"20px",outline:"none",transition:"border-color 0.3s","&:focus":{borderColor:"#5865f2",boxShadow:"0 0 8px rgba(88, 101, 242, 0.5)"},"@media (max-width: 600px)":{height:"40px"}}),ao=Object(k.a)("p")({color:"#ff4d4d",fontSize:"0.85rem",marginTop:"-15px",marginBottom:"10px","@media (max-width: 600px)":{fontSize:"0.75rem"}}),no=Object(k.a)(Yt.a)({width:"100%",height:"50px",fontSize:"1rem",fontWeight:600,background:"linear-gradient(135deg, #5865f2, #4c55d3)",color:"#ffffff",textTransform:"none",borderRadius:"10px",boxShadow:"0px 4px 12px rgba(88, 101, 242, 0.4)",transition:"background 0.3s, box-shadow 0.3s","&:hover":{background:"linear-gradient(135deg, #4c55d3, #3b44b0)",boxShadow:"0px 4px 16px rgba(88, 101, 242, 0.6)"},"@media (max-width: 600px)":{height:"45px",fontSize:"0.9rem"}}),oo=Object(k.a)("span")({color:"#00aff4",fontWeight:500,cursor:"pointer",transition:"color 0.3s","&:hover":{color:"#008ecc"},"@media (max-width: 600px)":{fontSize:"0.85rem"}});var ro=()=>{const e=Object(l.q)(),[t,a]=Object(n.useState)({email:"",password:""}),[o,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(!1),[d,h]=Object(n.useState)({}),u=Object(i.b)(),{userDetails:p}=Y((e=>e.auth)),j=e=>{const{name:t,value:n}=e.target;a((e=>({...e,[t]:n}))),h((e=>({...e,[t]:""})))};Object(n.useEffect)((()=>{r(0===Object.keys(Na(t)).length)}),[t]),Object(n.useEffect)((()=>{console.log("User details after login:",p),null!==p&&void 0!==p&&p.token&&e("/dashboard")}),[p,e]);return Object(Ee.jsx)(Xn,{children:Object(Ee.jsxs)(_n,{elevation:4,children:[Object(Ee.jsx)($n,{src:Kn,alt:"Sirun Logo"}),Object(Ee.jsx)(Me.a,{variant:"h5",sx:{color:"white",fontWeight:"bold",mb:3},children:"Welcome Back to Sirun"}),Object(Ee.jsx)(Me.a,{sx:{color:"#b3b5c3",mb:3,fontSize:"0.95rem"},children:"Log in to continue connecting with friends."}),Object(Ee.jsx)(Ae.a,{sx:{mb:3,borderColor:"#44475a"}}),Object(Ee.jsxs)(we.a,{sx:{textAlign:"left"},children:[Object(Ee.jsx)(eo,{children:"Email"}),Object(Ee.jsx)(to,{type:"email",placeholder:"Enter your email",name:"email",value:t.email,onChange:j}),d.email&&Object(Ee.jsx)(ao,{children:d.email})]}),Object(Ee.jsxs)(we.a,{sx:{textAlign:"left"},children:[Object(Ee.jsx)(eo,{children:"Password"}),Object(Ee.jsxs)(we.a,{sx:{display:"flex",alignItems:"center"},children:[Object(Ee.jsx)(to,{type:s?"text":"password",placeholder:"Enter password",name:"password",value:t.password,onChange:j,style:{flexGrow:1}}),Object(Ee.jsx)(Ie.a,{onClick:()=>{c((e=>!e))},sx:{color:"#72767d"},children:s?Object(Ee.jsx)(qn.a,{}):Object(Ee.jsx)(Jn.a,{})})]}),d.password&&Object(Ee.jsx)(ao,{children:d.password})]}),Object(Ee.jsx)($a.a,{title:o?"Proceed to Log In":"Ensure your email and password meet the requirements.",children:Object(Ee.jsx)(no,{variant:"contained",disabled:!o,onClick:()=>{const e=Na(t);if(console.log("Validation errors:",e),0!==Object.keys(e).length)return h(e),void console.log("Form validation failed with errors:",e);h({}),console.log("Dispatching login with credentials:",t),u(S(t))},children:"Log In"})}),Object(Ee.jsxs)(Me.a,{sx:{color:"#72767d",mt:3},variant:"subtitle2",children:["Don't have an account?"," ",Object(Ee.jsx)(oo,{onClick:()=>e("/register"),children:"Sign Up"})]})]})})};const so=Object(k.a)(we.a)({display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"radial-gradient(circle at top left, #1f2235, #141625)",padding:"20px"}),io=Object(k.a)(Hn.a)({padding:"40px 35px",maxWidth:"400px",width:"100%",background:"#1e1f2b",borderRadius:"15px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.6)",textAlign:"center",color:"#d9d9d9",position:"relative",animation:"fadeIn 1s ease-out","@keyframes fadeIn":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}},"@media (max-width: 600px)":{padding:"30px 20px",maxWidth:"90%"}}),co=Object(k.a)("img")({width:"70px",height:"70px",marginBottom:"25px",filter:"brightness(1.3) contrast(1.1)"}),lo=Object(k.a)(Me.a)({color:"#b3b5c3",fontSize:"0.85rem",fontWeight:600,marginBottom:"8px",textAlign:"left","@media (max-width: 600px)":{fontSize:"0.8rem"}}),ho=Object(k.a)("input")({width:"100%",height:"45px",border:"1px solid #3a3b4d",borderRadius:"8px",background:"#252738",padding:"0 15px",color:"#e0e0e0",fontSize:"1rem",marginBottom:"20px",outline:"none",transition:"border-color 0.3s","&:focus":{borderColor:"#5865f2",boxShadow:"0 0 8px rgba(88, 101, 242, 0.5)"},"@media (max-width: 600px)":{height:"40px"}}),uo=Object(k.a)("p")({color:"#ff4d4d",fontSize:"0.85rem",marginTop:"-15px",marginBottom:"10px","@media (max-width: 600px)":{fontSize:"0.75rem"}}),po=Object(k.a)(Yt.a)({width:"100%",height:"50px",fontSize:"1rem",fontWeight:600,background:"linear-gradient(135deg, #5865f2, #4c55d3)",color:"#ffffff",textTransform:"none",borderRadius:"10px",boxShadow:"0px 4px 12px rgba(88, 101, 242, 0.4)",transition:"background 0.3s, box-shadow 0.3s","&:hover":{background:"linear-gradient(135deg, #4c55d3, #3b44b0)",boxShadow:"0px 4px 16px rgba(88, 101, 242, 0.6)"},"@media (max-width: 600px)":{height:"45px",fontSize:"0.9rem"}}),jo=Object(k.a)("span")({color:"#00aff4",fontWeight:500,cursor:"pointer",transition:"color 0.3s","&:hover":{color:"#008ecc"},"@media (max-width: 600px)":{fontSize:"0.85rem"}});var go=()=>{const e=Object(l.q)(),[t,a]=Object(n.useState)({email:"",password:"",username:""}),[o,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(!1),[d,h]=Object(n.useState)({}),u=Object(i.b)(),{userDetails:p}=Y((e=>e.auth)),j=e=>{const{name:t,value:n}=e.target;a((e=>({...e,[t]:n}))),h((e=>({...e,[t]:""})))};Object(n.useEffect)((()=>{r(0===Object.keys(Ya(t)).length)}),[t]),Object(n.useEffect)((()=>{null!==p&&void 0!==p&&p.token&&e("/login")}),[p,e]);return Object(Ee.jsx)(so,{children:Object(Ee.jsxs)(io,{elevation:4,children:[Object(Ee.jsx)(co,{src:Kn,alt:"Sirun Logo"}),Object(Ee.jsx)(Me.a,{variant:"h5",sx:{color:"white",fontWeight:"bold",mb:3},children:"Join Sirun Today"}),Object(Ee.jsx)(Me.a,{sx:{color:"#b3b5c3",mb:3,fontSize:"0.95rem"},children:"Create an account to connect with friends securely."}),Object(Ee.jsx)(Ae.a,{sx:{mb:3,borderColor:"#44475a"}}),Object(Ee.jsxs)(we.a,{sx:{textAlign:"left"},children:[Object(Ee.jsx)(lo,{children:"Username"}),Object(Ee.jsx)(ho,{type:"text",placeholder:"Enter your username",name:"username",value:t.username,onChange:j}),d.username&&Object(Ee.jsx)(uo,{children:d.username})]}),Object(Ee.jsxs)(we.a,{sx:{textAlign:"left"},children:[Object(Ee.jsx)(lo,{children:"Email"}),Object(Ee.jsx)(ho,{type:"email",placeholder:"Enter your email",name:"email",value:t.email,onChange:j}),d.email&&Object(Ee.jsx)(uo,{children:d.email})]}),Object(Ee.jsxs)(we.a,{sx:{textAlign:"left"},children:[Object(Ee.jsx)(lo,{children:"Password"}),Object(Ee.jsxs)(we.a,{sx:{display:"flex",alignItems:"center"},children:[Object(Ee.jsx)(ho,{type:s?"text":"password",placeholder:"Enter password",name:"password",value:t.password,onChange:j,style:{flexGrow:1}}),Object(Ee.jsx)(Ie.a,{onClick:()=>{c((e=>!e))},sx:{color:"#72767d"},children:s?Object(Ee.jsx)(qn.a,{}):Object(Ee.jsx)(Jn.a,{})})]}),d.password&&Object(Ee.jsx)(uo,{children:d.password})]}),Object(Ee.jsx)($a.a,{title:o?"Proceed to Register":"Ensure your email, username, and password meet the requirements.",children:Object(Ee.jsx)(po,{variant:"contained",disabled:!o,onClick:()=>{const e=Ya(t);Object.keys(e).length>0?h(e):u(A(t))},children:"Sign Up"})}),Object(Ee.jsxs)(Me.a,{sx:{color:"#72767d",mt:3},variant:"subtitle2",children:["Already have an account?"," ",Object(Ee.jsx)(jo,{onClick:()=>e("/login"),children:"Log In"})]})]})})},mo=a(321),xo=a(323);var bo=()=>{const e=Object(i.b)(),{open:t,message:a}=Y((e=>e.alert));return Object(Ee.jsx)(xo.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,onClose:()=>{e({type:p.hideAlert})},autoHideDuration:6e3,children:Object(Ee.jsx)(mo.a,{severity:"info",children:a})})},Oo=a(335);const fo=Object(Ja.a)("div")({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100vh",backgroundColor:"#2F3136"});function vo(){return Object(Ee.jsx)(fo,{children:Object(Ee.jsx)(Oo.a,{})})}var yo=function(){const e=Object(i.b)(),{loading:t}=Y((e=>e.auth));return Object(n.useEffect)((()=>{e(C())}),[e]),t?Object(Ee.jsx)(vo,{}):Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(c.a,{children:Object(Ee.jsxs)(l.d,{children:[Object(Ee.jsx)(l.b,{path:"/register",element:Object(Ee.jsx)(go,{})}),Object(Ee.jsx)(l.b,{path:"/login",element:Object(Ee.jsx)(ro,{})}),Object(Ee.jsx)(l.b,{path:"/dashboard",element:Object(Ee.jsx)(Pn,{})}),Object(Ee.jsx)(l.b,{path:"*",element:Object(Ee.jsx)(l.a,{to:"/dashboard"})})]})}),Object(Ee.jsx)(bo,{})]})};const wo=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function So(e,t){navigator.serviceWorker.register(e).then((e=>{console.log("Service Worker registered with scope:",e.scope),e.pushManager?e.pushManager.getSubscription().then((e=>{e?console.log("Push subscription exists:",e):console.log("No existing push subscription found.")})).catch((e=>{console.error("Failed to retrieve push subscription:",e)})):console.warn("Push Manager is not available in this context."),e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available; please close all tabs to see the update."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Service Worker registration failed:",e)}))}s.a.render(Object(Ee.jsx)(o.a.StrictMode,{children:Object(Ee.jsx)(i.a,{store:N,children:Object(Ee.jsx)(yo,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/service-worker.js";wo?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):So(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):So(t,e)}))}}()}},[[247,1,2]]]);
//# sourceMappingURL=main.a1581f76.chunk.js.map